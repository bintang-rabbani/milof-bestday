<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="title" content="Happy Birthday Website 2.0 | Aoudumber Bade">
    <meta name="github" content="https://github.com/Aoudumber-Bade">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <title>Milof Birthday</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Poppins:wght@400;600&display=swap"
        rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</head>

<body>
    <!-- Consent overlay: blocks interaction until user chooses to turn on background music -->
    <div class="music-consent" role="dialog" aria-modal="true">
        <div class="consent-card">
            <h2>Turn on background music?</h2>
            <p>Enable background music for a better experience. You can mute or skip anytime.</p>
            <div class="consent-actions">
                <button class="btn-turn-on">Turn On</button>
                <button class="btn-skip">Skip</button>
            </div>
        </div>
    </div>

    <!-- Music player: minimized on small screens. Click the chevron to expand -->
    <div class="music-player minimized" aria-hidden="false">
        <button class="toggle-btn" aria-label="Toggle player"><i class="fas fa-chevron-up"></i></button>
        <div class="song-info">
            <p class="title">Song Title</p>
            <p class="artist">Artist</p>
        </div>
        <div class="controls">
            <button class="prev-btn">
                <i class="fas fa-backward"></i>
            </button>
            <button class="play-btn">
                <i class="fas fa-play"></i>
            </button>
            <button class="next-btn">
                <i class="fas fa-forward"></i>
            </button>
        </div>
        <div class="progress-area">
            <div class="progress-bar"></div>
        </div>
        <audio id="main-audio" src=""></audio>
    </div>

    <div id="wrapper">
        <div class="flag__birthday">
            <img src="./images/1.png" alt="" width="350" class="flag__left">
            <img src="./images/1.png" alt="" width="350" class="flag__right">
        </div>
        <div class="content">
            <div class="left">
                <div class="title">
                    <h1 class="happy">
                        <span style="--t: 4s;">H</span>
                        <span style="--t: 4.2s;">a</span>
                        <span style="--t: 4.4s;">p</span>
                        <span style="--t: 4.6s;">p</span>
                        <span style="--t: 4.8s;">y</span>
                    </h1>
                    <h1 class="birthday">
                        <span style="--t: 5s;">B</span>
                        <span style="--t: 5.2s;">i</span>
                        <span style="--t: 5.4s;">r</span>
                        <span style="--t: 5.6s;">t</span>
                        <span style="--t: 5.8s;">h</span>
                        <span style="--t: 6s;">d</span>
                        <span style="--t: 6.2s;">a</span>
                        <span style="--t: 6.4s;">y</span>
                    </h1>
                    <div class="hat">
                        <img src="./images/hat.png" alt="" width="130">
                    </div>
                </div>
                <div class="date__of__birth">
                    <span></span>
                </div>
                <div class="btn">
                    <button id="btn__letter">
                        <div class="mail">
                            Click Here Bebe!
                            <i class="fa-regular fa-envelope"></i>
                        </div>
                    </button>

                </div>
            </div>
            <div class="right">
                <div class="box__account">
                    <div class="image">
                        <img src="./images/araitum.png" alt="">
                    </div>
                    <div class="name">
                        <i class="fa-solid fa-heart"></i>
                        <span>Dear Mutiara</span>
                        <i class="fa-solid fa-heart"></i>
                    </div>
                    <div class="balloon_one">
                        <img width="100px" src="./images/balloon1.png" alt="">
                    </div>
                    <div class="balloon_two">
                        <img width="100px" src="./images/balloon2.png" alt="">
                    </div>
                </div>
                <div class="cricle">
                    <div class="text__cricle">
                        <span style="--i: 1;">h</span>
                        <span style="--i: 2;">a</span>
                        <span style="--i: 3;">p</span>
                        <span style="--i: 4;">p</span>
                        <span style="--i: 5;">y</span>
                        <span style="--i: 6;">-</span>
                        <span style="--i: 7;">b</span>
                        <span style="--i: 8;">i</span>
                        <span style="--i: 9;">r</span>
                        <span style="--i: 10;">t</span>
                        <span style="--i: 11;">h</span>
                        <span style="--i: 12;">d</span>
                        <span style="--i: 13;">a</span>
                        <span style="--i: 14;">y</span>
                        <span style="--i: 15;">-</span>
                    </div>
                    <i class="fa-solid fa-heart"></i>
                </div>
            </div>
        </div>
        <div class="decorate_star star1" style="--t: 15s;"></div>
        <div class="decorate_star star2" style="--t: 15.2s;"></div>
        <div class="decorate_star star3" style="--t: 15.4s;"></div>
        <div class="decorate_star star4" style="--t: 15.6s;"></div>
        <div class="decorate_star star5" style="--t: 15.8s;"></div>
        <div class="decorate_flower--one" style="--t: 15s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--two" style="--t: 15.3s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--three" style="--t: 15.6s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_bottom">
            <img src="./images/decorate.png" alt="" width="100">
        </div>
        <div class="smiley__icon">
            <img src="./images/smiley_icon.png" alt="" width="100">
        </div>


        <div class="boxMail">
            <i class="fa-solid fa-xmark"></i>
            <div class="boxMail-container">
                <div class="card1">
                    <div class="userImg">
                        <img src="images/mutiara.png" alt="">
                    </div>
                    <h4 class="username">To: Mutiara Khadijah ðŸ’–<span class="underline"></span></h4>
                    <h3>Happy Birthday</h3>
                </div>
                <div class="card2">
                    <div class="card2-content">
                        <h3>My Gorgeus Love!</h3>
                        <h2>Untuk kamu, kekasihku.
                            Selamat ulang tahun ke-22, duniaku. Mencintai adalah kata kerja, dicintai adalah kata sifat. Tetapi cinta bukanlah kata benda, cinta adalah kata hati. Aku mengenalmu tanpa sengaja.
                            Bagaikan hidup dan alam semesta, saling terikat untuk terus tumbuh bersama. 
                            Di umurmu yang semakin bertambah ini, semoga segala harapan dan semua yang kamu inginkan serta impikan dapat terwujud dan tercapai.
                            I'll always be by your side, loving, supporting, and so proud you. Kamu adalah kesayangankuu, cintaa matiku, my one and only wifeeyy yang paling cantik, imut, lusyu, maniez, sexy di hatiku.
                        </h2>
                        <h3>- Tang ðŸ’•ðŸŒ¹
                        </h3>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script>
    let datetxt = "05 November 2025";
    let datatxtletter = "My love. You are a very special girl. I always silently thank you for coming into my life. Today, I wish you all the best, lots of health, and lots of joy. I always hope we will celebrate many more birthdays like this together. Happy birthday to you.ðŸ’•";
    let titleLetter = "To you";
    let charArrDate = datetxt.split('');
    let charArrDateLetter = datatxtletter.split('');
    let charArrTitle = titleLetter.split('');
    let currentIndex = 0;
    let currentIndexLetter = 0;
    let currentIndexTitle = 0;
    let date__of__birth = document.querySelector(".date__of__birth span");
    setTimeout(function () {
        timeDatetxt = setInterval(function () {
            if (currentIndex < charArrDate.length) {
                date__of__birth.textContent += charArrDate[currentIndex];
                currentIndex++;
            }
            else {
                let i = document.createElement("i");
                i.className = "fa-solid fa-star"
                document.querySelector(".date__of__birth").prepend(i)
                document.querySelector(".date__of__birth").appendChild(i.cloneNode(true))
                clearInterval(timeDatetxt)
            }
        }, 100)
    }, 12000)
    // Removed old letter close handler since we're using the new boxMail implementation



    let mailBox = document.querySelector('.mail')
    let boxmail = document.querySelector('.boxMail')
    let boxmailContainer = document.querySelector('.boxMail-container')
    var close = document.querySelector('.fa-xmark')
    let isMailOpen = false
    
    mailBox.onclick = function () {
        mailBox.classList.toggle('active')
        boxmail.classList.add('active')
    }

    // Toggle mail open/close on click
    boxmailContainer.onclick = function(e) {
        // If currently closed, open on any click inside container
        if (!isMailOpen) {
            isMailOpen = true;
            boxmailContainer.classList.add('open');
            return;
        }

        // If currently open: close when user clicks outside the left card (card1)
        // This allows clicking the right card (card2) contents (h2/h3/text) to close the mail.
        const clickedCard1 = e.target.closest('.card1');
        if (!clickedCard1) {
            isMailOpen = false;
            boxmailContainer.classList.remove('open');
        }
    }

    close.addEventListener('click', function (e) {
        e.stopPropagation(); // Prevent triggering boxmailContainer click
        boxmailContainer.classList.remove('open')
        isMailOpen = false;
        setTimeout(() => {
            boxmail.classList.remove('active')
        }, 300)
    })

    // Music Player Implementation
    const musicPlayer = {
        container: document.querySelector('.music-player'),
        audio: document.querySelector('#main-audio'),
        playBtn: document.querySelector('.play-btn'),
        prevBtn: document.querySelector('.prev-btn'),
        nextBtn: document.querySelector('.next-btn'),
        progressArea: document.querySelector('.progress-area'),
        progressBar: document.querySelector('.progress-bar'),
        titleText: document.querySelector('.song-info .title'),
        artistText: document.querySelector('.song-info .artist'),
        currentTrack: 0,
        isPlaying: false,

        // Daftar lagu dalam folder playlist
        playlist: [
            {
                title: "Lover Stay",
                artist: "Pamungkas",
                src: "./playlist/1. Pamungkas - Lover Stay Official Music Video [4zyyVrIANXw].mp3"
            },
            {
                title: "Toronto 2014",
                artist: "Daniel Caesar",
                src: "./playlist/2. Daniel Caesar - Toronto 2014 (Official Audio) [SHP-xh5NnVs].mp3"
            },
            {
                title: "P.S. I LOVE YOU",
                artist: "Paul Partohap",
                src: "./playlist/3. Paul Partohap - P.S. I LOVE YOU (Lyric Video).mp3"
            },
            {
                title: "If I Had A Gun",
                artist: "Noel Gallagher's High-Flying Birds",
                src: "./playlist/4. Noel Gallaghers High Flying Birds - If I Had A Gun.mp3"
            },
            {
                title: "Bergema Selamanya",
                artist: "Nadhif Basalamah",
                src: "./playlist/5. Nadhif Basalamah - bergema sampai selamanya (Stripped Version - Official Audio).mp3"
            }
            // Tambahkan lagu lainnya di sini dengan format yang sama
        ],

        init() {
            this.loadTrack(this.currentTrack);
            this.setupEventListeners();
        },

        loadTrack(index) {
            const song = this.playlist[index];
            this.audio.src = song.src;
            this.titleText.textContent = song.title;
            this.artistText.textContent = song.artist;
            this.updatePlayIcon();
        },

        togglePlay() {
            if (this.isPlaying) {
                this.audio.pause();
            } else {
                this.audio.play();
            }
            this.isPlaying = !this.isPlaying;
            this.updatePlayIcon();
        },

        updatePlayIcon() {
            const icon = this.playBtn.querySelector('i');
            icon.className = this.isPlaying ? 'fas fa-pause' : 'fas fa-play';
        },

        nextTrack() {
            this.currentTrack = (this.currentTrack + 1) % this.playlist.length;
            this.loadTrack(this.currentTrack);
            if (this.isPlaying) this.audio.play();
        },

        prevTrack() {
            this.currentTrack = (this.currentTrack - 1 + this.playlist.length) % this.playlist.length;
            this.loadTrack(this.currentTrack);
            if (this.isPlaying) this.audio.play();
        },

        updateProgress(e) {
            const { duration, currentTime } = e.srcElement;
            const progressPercent = (currentTime / duration) * 100;
            this.progressBar.style.width = `${progressPercent}%`;
        },

        setProgress(e) {
            const width = this.progressArea.clientWidth;
            const clickX = e.offsetX;
            const duration = this.audio.duration;
            this.audio.currentTime = (clickX / width) * duration;
        },

        setupEventListeners() {
            // Event listeners untuk kontrol musik
            this.playBtn.addEventListener('click', () => this.togglePlay());
            this.nextBtn.addEventListener('click', () => this.nextTrack());
            this.prevBtn.addEventListener('click', () => this.prevTrack());
            
            // Event listeners untuk progress bar
            this.audio.addEventListener('timeupdate', (e) => this.updateProgress(e));
            this.progressArea.addEventListener('click', (e) => this.setProgress(e));
            
            // Auto play next track when current one ends
            this.audio.addEventListener('ended', () => this.nextTrack());
        }
    };

    // Initialize music player
    musicPlayer.init();

    /* --- Consent overlay and autoplay handling --- */
    const consentOverlay = document.querySelector('.music-consent');
    const btnTurnOn = document.querySelector('.btn-turn-on');
    const btnSkip = document.querySelector('.btn-skip');
    const toggleBtn = document.querySelector('.toggle-btn');

    // Prevent page interaction until user chooses (overlay blocks clicks)
    function hideConsent() {
        consentOverlay.style.display = 'none';
    }

    btnTurnOn.addEventListener('click', () => {
        hideConsent();
        // Try to play; handle promise rejection
        musicPlayer.audio.play().then(() => {
            musicPlayer.isPlaying = true;
            musicPlayer.updatePlayIcon();
        }).catch((err) => {
            console.warn('Auto-play blocked or failed:', err);
        });
    });

    btnSkip.addEventListener('click', () => {
        hideConsent();
    });

    // Toggle expand/minimize player
    toggleBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        musicPlayer.container.classList.toggle('minimized');
        const icon = toggleBtn.querySelector('i');
        icon.className = musicPlayer.container.classList.contains('minimized') ? 'fas fa-chevron-up' : 'fas fa-chevron-down';
    });

    // Set initial minimized state only on first load
    function applyInitialMinimize() {
        if (!musicPlayer.container.classList.contains('minimized') && 
            !musicPlayer.container.classList.contains('expanded')) {
            musicPlayer.container.classList.add('minimized');
        }
    }
    applyInitialMinimize();
</script>

</html>